const pokemonRepository=(()=>{let e=[],t=document.querySelector(".loading"),o={normal:"#A8A77A",fire:"#EE8130",water:"#6390F0",electric:"#F7D02C",grass:"#7AC74C",ice:"#96D9D6",fighting:"#C22E28",poison:"#A33EA1",ground:"#E2BF65",flying:"#A98FF3",psychic:"#F95587",bug:"#A6B91A",rock:"#B6A136",ghost:"#735797",dragon:"#6F35FC",dark:"#705746",steel:"#B7B7CE",fairy:"#D685AD"};const n=t=>{"object"==typeof t&&"name"in t&&"detailsUrl"in t?e.push(t):console.log("Pokemon is not correct")},l=(e,t)=>{e.addEventListener("click",function(){s(t)})},s=e=>{pokemonRepository.loadDetails(e).then(()=>{a(e)})},a=e=>{let t=$(".modal-body"),o=$(".modal-title");t.empty(),o.empty();let n=`#${e.id} ${e.name}`,l=$(`<p class="mb-n1">\n                                Type: \n                                ${e.types.map(e=>`<span class="pokemon-type" style='background-color:${e.color}'}>${e.type}</span>`).join("")}\n                            </p>`),s=$(`<p class="mb-n1">\n                                    Height: <span class="text-bold">${e.height/10}m</span>\n                                </p>`),a=$(`<p class="mb-n1">\n                                    Weight: <span class="text-bold">${e.weight/10}Kg</span>\n                                </p>`),i=$('<img src="" alt="pokemon-pic" class="pokemon-img w-100 mx-auto">');i.attr("src",e.imageUrl),o.append(n),t.append(i),t.append(l),t.append(s),t.append(a)},i=()=>{t.classList.add("show")},r=()=>{setTimeout(()=>{t.classList.remove("show")},1e3)};let c=document.querySelector("#search-bar");c.addEventListener("input",()=>{let e=c.value.toLowerCase();document.querySelectorAll("li").forEach(t=>{t.innerText.toLowerCase().includes(e)?t.style.display="block":t.style.display="none"})});let d=document.getElementById("btn-back-to-top");window.onscroll=(()=>{p()});const p=()=>{document.body.scrollTop>20||document.documentElement.scrollTop>20?d.style.display="block":d.style.display="none"};return d.addEventListener("click",()=>{document.body.scrollTop=0,document.documentElement.scrollTop=0}),{add:n,addListItem:async e=>{let t=document.querySelector("#list-group"),o=document.createElement("li"),n=await(async e=>{const t=await fetch(e),o=await t.json();return o&&o.sprites.other.dream_world.front_default})(e.detailsUrl);o.classList.add("list-group-item","border-0","col-xl-2","col-lg-3","col-md-4","col-sm-6","col-xs-12","align-items-center");let s=document.createElement("button");s.innerHTML=`\n                                <p>${e.name}</p>\n                                <img src="${n}" alt="Pokemon image"/>\n                            `,s.classList.add("btn","text-capitalize","btn-lg","w-100","pokemon-card"),s.setAttribute("data-toggle","modal"),s.setAttribute("data-target","#pokemonModal"),o.appendChild(s),t.insertBefore(o,t.children[e.id]),l(s,e)},getAll:()=>e,loadDetails:e=>{let t=e.detailsUrl;return fetch(t).then(e=>e.json()).then(t=>{e.imageUrl=t.sprites.other.dream_world.front_default,e.height=t.height,e.types=t.types.map(e=>({type:e.type.name,color:o[e.type.name]})),e.weight=t.weight,e.id=t.id}).catch(e=>{console.error(e)})},loadList:()=>(i(),fetch("https://pokeapi.co/api/v2/pokemon/?limit=150").then(e=>e.json()).then(function(e){e.results.forEach((e,t)=>{let o={id:t,name:e.name,detailsUrl:e.url};n(o)}),r()}).catch(e=>{console.error(e),r()})),showDetails:s}})();pokemonRepository.loadList().then(()=>{pokemonRepository.getAll().forEach(e=>{pokemonRepository.addListItem(e)})});